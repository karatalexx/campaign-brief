generator client {
  provider   = "prisma-client-js"
  output     = "../generated/prisma"
  engineType = "client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Campaign {
  id             Int     @id @default(autoincrement())
  name           String
  industry       String
  targetAudience String  @map("target_audience")
  tone           Tone
  description    String?

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  headlines Headline[]
  images    Image[]
  creatives Creative[]

  @@map("campaigns")
}

enum Tone {
  PROFESSIONAL
  CASUAL
  EXCITING
  TRUSTWORTHY
}

model Headline {
  id         Int              @id @default(autoincrement())
  campaignId Int              @map("campaign_id")
  campaign   Campaign         @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  text       String?
  status     GenerationStatus
  createdAt  DateTime         @default(now()) @map("created_at")
  updatedAt  DateTime         @updatedAt @map("updated_at")

  creatives Creative[]

  @@map("headlines")
}

model Image {
  id         Int              @id @default(autoincrement())
  campaignId Int              @map("campaign_id")
  campaign   Campaign         @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  url        String?
  prompt     String?
  status     GenerationStatus

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  creatives Creative[]

  @@map("images")
}

enum GenerationStatus {
  PENDING
  COMPLETED
  FAILED
}

model Creative {
  id         Int       @id @default(autoincrement())
  campaignId Int?      @map("campaign_id")
  campaign   Campaign? @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  headlineId Int?      @map("headline_id")
  headline   Headline? @relation(fields: [headlineId], references: [id], onDelete: SetNull)
  imageId    Int?      @map("image_id")
  image      Image?    @relation(fields: [imageId], references: [id], onDelete: SetNull)
  createdAt  DateTime  @default(now()) @map("created_at")
  updatedAt  DateTime  @updatedAt @map("updated_at")

  @@map("creatives")
}
